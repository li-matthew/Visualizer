(this.webpackJsonpvisualizer=this.webpackJsonpvisualizer||[]).push([[0],{45:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),c=n(14),a=n.n(c),i=(n(45),n(16)),s=n.n(i),l=n(21),u=n(12),d=n(30),f=(n(31),n(67)),h=n(54),j=n(69),b=n(70),g=n(2),v=1,p=0,m=[20,255,235],y=function(){return Object(g.jsxs)("div",{class:"ControlBar",children:[Object(g.jsxs)(f.a,{color:"secondary",children:[Object(g.jsx)(h.a,{id:"butt",active:"true",children:"oscilloscope"}),Object(g.jsx)(h.a,{id:"butt",children:"bars"}),Object(g.jsx)(h.a,{id:"butt",children:"spectrogram"})]}),Object(g.jsx)(j.a,{class:"controlTitle",gutterBottom:!0,color:"inherit",children:"thickness"}),Object(g.jsx)(b.a,{id:"thickness",min:0,max:10,step:.01,defaultValue:1,valueLabelDisplay:"auto",color:"secondary",onChange:function(e,t){v=t}}),Object(g.jsx)(j.a,{class:"controlTitle",gutterBottom:!0,color:"inherit",children:"fade"}),Object(g.jsx)(b.a,{id:"fade",min:0,max:1,step:.01,defaultValue:0,valueLabelDisplay:"auto",color:"secondary",onChange:function(e,t){p=t}}),Object(g.jsx)(j.a,{class:"controlTitle",gutterBottom:!0,color:"inherit",children:"color"}),Object(g.jsxs)("div",{class:"color",children:[Object(g.jsx)(b.a,{id:"red",min:0,max:255,step:1,defaultValue:20,valueLabelDisplay:"auto",color:"secondary",onChange:function(e,t){m[0]=t}}),Object(g.jsx)(b.a,{id:"green",min:0,max:255,step:1,defaultValue:255,valueLabelDisplay:"auto",color:"secondary",onChange:function(e,t){m[1]=t}}),Object(g.jsx)(b.a,{id:"blue",min:0,max:255,step:1,defaultValue:235,valueLabelDisplay:"auto",color:"secondary",onChange:function(e,t){m[2]=t}})]})]})},O=function(e){var t=e.audioData,n=r.a.createRef();Object(o.useRef)([]);Object(o.useLayoutEffect)((function(){t.length>0&&(c(),console.log(v))}),[t]);var c=function(){var e=n.current,t=e.height,o=e.width,r=e.getContext("2d"),c="rgb(";c=c.concat(m[0]);for(var i=1;i<3;i++)c=(c=c.concat(", ")).concat(m[i]);c=c.concat(")"),r.fillStyle="rgba(0, 0, 0, "+(1-p)+")",r.fillRect(0,0,o,t),a(t,o,r,c,v)},a=function(e,n,o,r,c){var a=0,i=1*n/t.length;o.lineWidth=c,o.strokeStyle=r,o.beginPath();var s,l=Object(d.a)(t);try{for(l.s();!(s=l.n()).done;){var u=s.value/255*e/4;o.lineTo(a,u+e/3),a+=i}}catch(f){l.e(f)}finally{l.f()}o.stroke()};return Object(g.jsx)("canvas",{width:window.innerWidth/2,height:window.innerHeight/2,ref:n})},w=function(e){var t=e.stream,n=r.a.useState(new Uint8Array(0)),c=Object(u.a)(n,2),a=c[0],i=c[1],s=Object(o.useRef)(new AudioContext),l=Object(o.useRef)(),d=Object(o.useRef)(),f=Object(o.useRef)();return Object(o.useEffect)((function(){return t?(console.log("init stream"),l.current=s.current.createAnalyser(),l.current.fftSize=4096,l.current.smoothingTimeConstant=.9,i(new Uint8Array(l.current.fftSize)),d.current=s.current.createMediaStreamSource(t),d.current.connect(l.current)):console.log("no stream"),function(){console.log("cancel animation"),cancelAnimationFrame(f.current),l.current.disconnect(),d.current.disconnect()}}),[t]),Object(o.useLayoutEffect)((function(){f.current=requestAnimationFrame((function e(){var t=new Uint8Array(l.current.fftSize);l.current.getByteTimeDomainData(t),i(t),f.current=requestAnimationFrame(e)}))}),[]),Object(g.jsx)("div",{class:"Vis",children:Object(g.jsx)(O,{audioData:a})})},x=function(e){var t=e.controlAudio;return Object(g.jsx)("div",{class:"Header",children:Object(g.jsx)(h.a,{id:"butt",variant:"outlined",color:"secondary",onClick:t.toggleAudio,children:t.audio?"stop":"begin"})})},k=("".concat("https://accounts.spotify.com/authorize","?client_id=").concat("6d21bc23eaeb4573a2b668d8239e57ea","&redirect_uri=").concat("http://localhost:3000/callback/","&scope=").concat(["user-read-currently-playing","user-read-recently-played","user-read-playback-state","user-top-read","user-modify-playback-state"].join("%20"),"&response_type=token&show_dialog=true"),n(51),n(37),n(52),function(e){var t=r.a.useState(null),n=Object(u.a)(t,2),o=n[0],c=n[1],a=function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0,video:!1});case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)(j.a,{class:"title",variant:"h1",children:"sandwich time"}),Object(g.jsx)(x,{controlAudio:{audio:o,toggleAudio:function(){o?(o.getTracks().forEach((function(e){return e.stop()})),c(null)):a()}}}),o?Object(g.jsx)(w,{stream:o}):"",Object(g.jsx)(y,{})]})}),A=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function C(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a.a.render(Object(g.jsx)(k,{}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/Visualizer",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/Visualizer","/service-worker.js");A?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):C(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):C(e)}))}}()}},[[53,1,2]]]);
//# sourceMappingURL=main.b40f0256.chunk.js.map